"use strict";var mycanvas=document.getElementById("mycanvas"),ct=mycanvas.getContext("2d");function rndNum(n,t){return Math.floor(Math.random()*(t-n+1)+n)}function rndColor(n,t,a){var e=1;return 1<a&&(e=Math.random()),"rgba("+rndNum(n,t)+","+rndNum(n,t)+","+rndNum(n,t)+","+e+")"}var num="";function creatCode(){ct.fillStyle=rndColor(200,255,1),ct.fillRect(0,0,100,60),num="";for(var n=[0,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t=0;t<4;t++){var a=n[rndNum(0,n.length-1)];num+=a,ct.font="30px Palatino",ct.fillStyle=rndColor(0,180,1),ct.fillText(a,25*t+5,30)}for(t=0;t<20;t++)ct.strokeStyle=rndColor(150,255,2),ct.beginPath(),ct.lineWidth=1,ct.moveTo(rndNum(0,100),rndNum(0,40)),ct.lineTo(rndNum(0,100),rndNum(0,40)),ct.stroke();for(t=0;t<15;t++)ct.fillStyle=rndColor(50,255,2),ct.beginPath(),ct.arc(rndNum(0,100),rndNum(0,60),rndNum(1,3),0,2*Math.PI,!0),ct.fill(),ct.stroke()}creatCode(),mycanvas.onclick=creatCode,$("#myform").bootstrapValidator({message:"当前字段验证失败",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{username:{message:"用户名验证失败",validators:{notEmpty:{message:"用户名必须填写"},stringLength:{min:2,max:18,message:"用户名长度必须在2~18位之间"}}},checkCode:{message:"验证码验证失败",validators:{notEmpty:{message:"验证码必须填写"},callback:{callback:function(n){return n==num?{valid:!0}:{valid:!1,message:"验证码输入错误"}}}}},inputPassword1:{validators:{notEmpty:{message:"密码必须填写"},stringLength:{min:6,max:30,message:"密码长度必须在6~30位之间"}}}}}).on("success.form.bv",function(n){n.preventDefault();var t=$("#myform").serialize();$.post("../../API/userlogin.php",t,function(n){if(n.isok){$("#myModal").modal("show"),$("#myModalLabel").text(n.msg),$(".modal-body").html("<span class='glyphicon glyphicon-ok text-success'></span>"+n.msg+"<span id='num'>3</span>秒后跳转登录页面");var t=3,a=setInterval(function(){t--,$("#num").text(t),t<=0&&(clearInterval(a),location.href="/personal.php")},1e3)}else $("#myModal").modal("show"),$("#myModalLabel").text(n.msg),$(".modal-body").html("<span class='glyphicon glyphicon-remove text-danger'></span>"+n.msg)},"json")});